<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Studio Assistant ‚Äì Mr. J. C. Santos</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta
    name="description"
    content="Chat with the Studio Assistant about landing pages, automations, AI agents, and micro-SaaS builds."
  />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
    rel="stylesheet"
  />
  <style>
    :root {
      --bg: #030014;
      --accent: #8b5cf6;
      --accent-2: #22d3ee;
      --text: #f9fafb;
      --muted: #9ca3af;
      --border: rgba(148, 163, 184, 0.35);
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    html,
    body {
      height: 100%;
      font-family: "Poppins", system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
      background: radial-gradient(circle at top, #1e1b4b 0%, #020617 45%, #020617 100%);
      color: var(--text);
      overflow: hidden;
    }

    body {
      display: flex;
      align-items: stretch;
      justify-content: center;
      padding: 16px;
    }

    .chat-shell {
      position: relative;
      width: 100%;
      max-width: 980px;
      border-radius: 24px;
      border: 1px solid var(--border);
      background: radial-gradient(circle at 0 0, rgba(56, 189, 248, 0.22), rgba(15, 23, 42, 0.98));
      box-shadow: 0 32px 80px rgba(15, 23, 42, 0.95);
      display: grid;
      grid-template-rows: auto 1fr auto;
      overflow: hidden;
    }

    .chat-header {
      padding: 12px 16px;
      border-bottom: 1px solid rgba(15, 23, 42, 0.98);
      background: radial-gradient(circle at 0 0, rgba(129, 140, 248, 0.35), rgba(15, 23, 42, 0.98));
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
    }

    .chat-header-left {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .chat-avatar {
      width: 32px;
      height: 32px;
      border-radius: 999px;
      background: conic-gradient(from 210deg, #8b5cf6, #ec4899, #22d3ee, #f97316, #8b5cf6);
      padding: 2px;
      position: relative;
      overflow: hidden;
    }

    .chat-avatar-inner {
      width: 100%;
      height: 100%;
      border-radius: 999px;
      background: radial-gradient(circle at 20% 0, #020617 0, #020617 55%, #0b1120 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 13px;
      font-weight: 600;
      letter-spacing: 0.08em;
    }

    .chat-title-block {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .chat-title {
      font-size: 14px;
      font-weight: 600;
    }

    .chat-subtitle {
      font-size: 11px;
      color: #cbd5f5;
    }

    .chat-header-right {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 11px;
      color: var(--muted);
      flex-wrap: wrap;
    }

    .chat-status-dot {
      width: 7px;
      height: 7px;
      border-radius: 999px;
      background: #22c55e;
      box-shadow: 0 0 12px rgba(34, 197, 94, 0.9);
    }

    .chat-link-back {
      font-size: 11px;
      border-radius: 999px;
      padding: 5px 10px;
      border: 1px solid rgba(148, 163, 184, 0.7);
      background: rgba(15, 23, 42, 0.96);
      color: #e5e7eb;
      text-decoration: none;
      white-space: nowrap;
    }

    .chat-link-back:hover {
      border-color: var(--accent);
    }

    .callback-btn {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      border: 1px solid rgba(148, 163, 184, 0.6);
      background: linear-gradient(135deg, rgba(34, 211, 238, 0.12), rgba(139, 92, 246, 0.14));
      color: #e5e7eb;
      padding: 6px 12px;
      border-radius: 999px;
      cursor: pointer;
      font-size: 11px;
      font-weight: 600;
      transition: transform 0.1s ease, border-color 0.15s ease;
      white-space: nowrap;
    }

    .callback-btn:hover {
      transform: translateY(-1px);
      border-color: var(--accent);
    }

    .callback-btn .dot {
      width: 8px;
      height: 8px;
      border-radius: 999px;
      background: #22c55e;
      box-shadow: 0 0 10px rgba(34, 197, 94, 0.7);
    }

    .callback-feedback {
      font-size: 10px;
      color: #cbd5f5;
    }

    .chat-messages {
      padding: 14px 16px 12px;
      overflow-y: auto;
      display: flex;
      flex-direction: column;
      gap: 10px;
      font-size: 13px;
    }

    .chat-message-row {
      display: flex;
    }

    .chat-message-row.user {
      justify-content: flex-end;
    }

    .chat-message-row.bot {
      justify-content: flex-start;
    }

    .chat-message-bubble {
      max-width: 80%;
      padding: 9px 11px;
      border-radius: 14px;
      line-height: 1.45;
      word-wrap: break-word;
      white-space: pre-wrap;
    }

    .chat-message-row.user .chat-message-bubble {
      background: linear-gradient(135deg, #22d3ee, #8b5cf6);
      color: #f9fafb;
      border-bottom-right-radius: 4px;
    }

    .chat-message-row.bot .chat-message-bubble {
      background: rgba(15, 23, 42, 0.96);
      border: 1px solid rgba(75, 85, 99, 0.9);
      color: #e5e7eb;
      border-bottom-left-radius: 4px;
    }

    .chat-message-meta {
      font-size: 10px;
      color: var(--muted);
      margin-top: 2px;
    }

    .chat-typing {
      display: inline-flex;
      align-items: center;
      gap: 3px;
    }

    .chat-typing-dot {
      width: 4px;
      height: 4px;
      border-radius: 999px;
      background: #cbd5f5;
      opacity: 0.6;
      animation: typing-bounce 1.4s infinite ease-in-out;
    }

    .chat-typing-dot:nth-child(2) {
      animation-delay: 0.15s;
    }

    .chat-typing-dot:nth-child(3) {
      animation-delay: 0.3s;
    }

    @keyframes typing-bounce {
      0%, 60%, 100% {
        transform: translateY(0);
        opacity: 0.4;
      }
      30% {
        transform: translateY(-3px);
        opacity: 1;
      }
    }

    .chat-input-bar {
      padding: 10px 12px;
      border-top: 1px solid rgba(15, 23, 42, 0.98);
      background: rgba(15, 23, 42, 0.98);
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .chat-input-wrapper {
      flex: 1;
      position: relative;
    }

    .chat-input {
      width: 100%;
      border-radius: 999px;
      border: 1px solid rgba(75, 85, 99, 0.9);
      background: rgba(15, 23, 42, 0.96);
      color: #e5e7eb;
      padding: 8px 12px;
      font-size: 13px;
      outline: none;
    }

    .chat-input:focus {
      border-color: var(--accent);
      box-shadow: 0 0 0 1px rgba(139, 92, 246, 0.7);
    }

    .chat-send-btn {
      border-radius: 999px;
      border: none;
      padding: 8px 14px;
      font-size: 12px;
      cursor: pointer;
      background: radial-gradient(circle at 0 0, var(--accent-2), var(--accent));
      color: #f9fafb;
      white-space: nowrap;
    }

    .chat-send-btn:disabled {
      opacity: 0.6;
      cursor: default;
    }

    .chat-hint {
      font-size: 10px;
      color: var(--muted);
      margin-top: 3px;
    }

    @media (max-width: 768px) {
      body {
        padding: 10px;
      }

      .chat-shell {
        border-radius: 18px;
      }

      .chat-messages {
        padding-inline: 12px;
      }

      .chat-message-bubble {
        max-width: 90%;
      }

      .chat-subtitle {
        display: none;
      }
    }

    @media (max-width: 480px) {
      body {
        padding: 0;
      }

      .chat-shell {
        border-radius: 0;
      }
    }
  </style>
</head>
<body>
  <div class="chat-shell">
    <header class="chat-header">
      <div class="chat-header-left">
        <div class="chat-avatar">
          <div class="chat-avatar-inner">JS</div>
        </div>
        <div class="chat-title-block">
          <div class="chat-title">Studio Assistant</div>
          <div class="chat-subtitle">Ask about services, pricing, and what we can build.</div>
        </div>
      </div>
      <div class="chat-header-right">
        <span class="chat-status-dot"></span>
        <span>Typically replies in a few minutes</span>
        <button class="callback-btn" id="callback-btn" type="button">
          <span class="dot"></span>
          Text for a callback ¬∑ 201-450-5416
        </button>
        <span class="callback-feedback" id="callback-feedback"></span>
        <!-- Change href to your main page -->
        <a href="index.html" class="chat-link-back">‚Üê Back to main site</a>
      </div>
    </header>

    <main class="chat-messages" id="chat-messages">
      <div class="chat-message-row bot">
        <div class="chat-message-bubble">
          Hey, I‚Äôm the studio assistant üëã
          Tell me what you‚Äôre trying to build or fix ‚Äì landing pages, automations, AI chatbots, or micro-SaaS.
        </div>
      </div>
      <div class="chat-message-row bot">
        <div class="chat-message-bubble">
          Helpful prompts:
          ‚Ä¢ ‚ÄúI want a landing page for [product] for [audience]‚Äù
          ‚Ä¢ ‚ÄúAutomate my [manual process]‚Äù
          ‚Ä¢ ‚ÄúI have an idea for a SaaS that does [X]‚Äù
        </div>
      </div>
    </main>

    <footer class="chat-input-bar">
      <form id="chat-form" style="display:flex; gap:8px; width:100%;">
        <div class="chat-input-wrapper">
          <input
            id="chat-input"
            class="chat-input"
            type="text"
            autocomplete="off"
            placeholder="Ask a question or describe your project‚Ä¶"
          />
          <div class="chat-hint">
            Press <strong>Enter</strong> to send. Shift+Enter for a new line.
          </div>
        </div>
        <button type="submit" class="chat-send-btn" id="chat-send-btn">
          Send
        </button>
      </form>
    </footer>
  </div>

  <!-- Your backend/LLM logic will live here -->
  <script src="chatbot.js"></script>

  <script>
    (function () {
      const messagesEl = document.getElementById("chat-messages");
      const formEl = document.getElementById("chat-form");
      const inputEl = document.getElementById("chat-input");
      const sendBtn = document.getElementById("chat-send-btn");
      const conversation = loadStoredConversation();
      const sessionId = loadOrCreateSessionId();
      const callbackBtn = document.getElementById("callback-btn");
      const callbackFeedback = document.getElementById("callback-feedback");

      if (conversation.length) {
        messagesEl.innerHTML = "";
        conversation.forEach((entry) => appendMessage(entry.content, entry.role));
      }

      function appendMessage(text, sender = "bot", options = {}) {
        const row = document.createElement("div");
        row.className = "chat-message-row " + (sender === "user" ? "user" : "bot");

        const bubble = document.createElement("div");
        bubble.className = "chat-message-bubble";
        bubble.textContent = text;

        row.appendChild(bubble);

        if (options.meta) {
          const meta = document.createElement("div");
          meta.className = "chat-message-meta";
          meta.textContent = options.meta;
          row.appendChild(meta);
        }

        messagesEl.appendChild(row);
        messagesEl.scrollTop = messagesEl.scrollHeight;

        return row;
      }

      function appendTyping() {
        const row = document.createElement("div");
        row.className = "chat-message-row bot";

        const bubble = document.createElement("div");
        bubble.className = "chat-message-bubble";

        const typing = document.createElement("div");
        typing.className = "chat-typing";

        for (let i = 0; i < 3; i++) {
          const dot = document.createElement("span");
          dot.className = "chat-typing-dot";
          typing.appendChild(dot);
        }

        bubble.appendChild(typing);
        row.appendChild(bubble);
        messagesEl.appendChild(row);
        messagesEl.scrollTop = messagesEl.scrollHeight;

        return row;
      }

      async function handleSubmit(event) {
        event.preventDefault();
        const raw = inputEl.value;
        if (!raw.trim()) return;

        const content = raw.trim();
        inputEl.value = "";
        appendMessage(content, "user");
        conversation.push({ role: "user", content });

        // Lock UI while waiting
        sendBtn.disabled = true;
        inputEl.disabled = true;

        const typingRow = appendTyping();

        let replyText = "";
        try {
          if (typeof window.chatbotSend === "function") {
            replyText = await window.chatbotSend(content, conversation, sessionId);
          } else {
            // Fallback if chatbot.js isn't set up yet
            replyText =
              "I‚Äôm ready for your backend logic in chatbot.js.\n\n" +
              "Right now I‚Äôm just echoing:\n\n" +
              content;
          }
        } catch (err) {
          console.error(err);
          replyText =
            "Something went wrong talking to the backend.\n" +
            "You can still reach me directly at baitjet@gmail.com.";
        } finally {
          // Remove typing indicator
          typingRow.remove();
          const finalReply = replyText || "No reply received from backend.";
          appendMessage(finalReply, "bot");
          conversation.push({ role: "assistant", content: finalReply });
          persistConversation(conversation);
          sendBtn.disabled = false;
          inputEl.disabled = false;
          inputEl.focus();
        }
      }

      // Handle Enter vs Shift+Enter
      inputEl.addEventListener("keydown", (e) => {
        if (e.key === "Enter" && !e.shiftKey) {
          e.preventDefault();
          formEl.requestSubmit();
        }
      });

      formEl.addEventListener("submit", handleSubmit);

      // Little UX bonus: focus on load
      window.addEventListener("load", () => {
        inputEl.focus();
      });

      // Callback button: copy number and attempt to open SMS
      callbackBtn?.addEventListener("click", async () => {
        const number = "201-450-5416";
        try {
          if (navigator.clipboard?.writeText) {
            await navigator.clipboard.writeText(number);
            callbackFeedback.textContent = "Number copied. Ready to text?";
          } else {
            callbackFeedback.textContent = "Text Santos at 201-450-5416.";
          }
        } catch (e) {
          callbackFeedback.textContent = "Text Santos at 201-450-5416.";
        }

        // Try to open SMS intent; fallback to tel
        const smsLink = "sms:+12014505416";
        const telLink = "tel:+12014505416";
        const anchor = document.createElement("a");
        anchor.style.display = "none";
        anchor.href = smsLink;
        document.body.appendChild(anchor);
        anchor.click();
        document.body.removeChild(anchor);

        // Fallback after a short delay
        setTimeout(() => {
          const telAnchor = document.createElement("a");
          telAnchor.style.display = "none";
          telAnchor.href = telLink;
          document.body.appendChild(telAnchor);
          telAnchor.click();
          document.body.removeChild(telAnchor);
        }, 400);
      });

      function persistConversation(convo) {
        try {
          localStorage.setItem("chat_conversation", JSON.stringify(convo.slice(-16)));
        } catch (e) {
          console.warn("Unable to persist conversation", e);
        }
      }

      function loadStoredConversation() {
        try {
          const raw = localStorage.getItem("chat_conversation");
          if (!raw) return [];
          const parsed = JSON.parse(raw);
          if (!Array.isArray(parsed)) return [];
          return parsed
            .filter(
              (entry) =>
                entry &&
                typeof entry.content === "string" &&
                (entry.role === "user" || entry.role === "assistant")
            )
            .map((entry) => ({ role: entry.role, content: entry.content }))
            .slice(-16);
        } catch (e) {
          console.warn("Unable to load stored conversation", e);
          return [];
        }
      }

      function loadOrCreateSessionId() {
        try {
          const existing = localStorage.getItem("chat_session_id");
          if (existing) return existing;
          const id = crypto.randomUUID ? crypto.randomUUID() : "sess-" + Math.random().toString(36).slice(2);
          localStorage.setItem("chat_session_id", id);
          return id;
        } catch (e) {
          return "sess-" + Math.random().toString(36).slice(2);
        }
      }
    })();
  </script>
</body>
</html>
